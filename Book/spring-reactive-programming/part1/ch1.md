# Chapter 01 리액티브 시스템과 리액티브 프로그래밍
> 리액티브 시스템과 리액티브 프로그래밍이 무엇인지 살펴보자

https://www.reactive-streams.org/

## 1.1 리액티브 시스템이란?
- 리액티브(Reactive) 용어의 의미란?
  - 사전적 의미로는 "반응을 하는"이라는 뜻이다. 즉, 어떤 이벤트나 상황이 발생했을 때, 반응을 해서 그에 따라 적절하게 행동하는 것을 의미한다.
  - 리액티브 시스템
    - 반응을 잘하는 시스템
    - 즉, 클라이언트의 요청에 머뭇거리지 않고 반응을 잘해서 즉시 응답해 주는 것
    - 클라이언트의 요청에 즉각적으로 응답함으로써 지연 시간을 최소화한다.

## 1.2 리액티브 선언문으로 리액티브 시스템 이해하기
- 리액티브 선언문은 리액티브라는 용어의 의미를 올바르게 정의하기 위해 노력하는 사람들이 만든 리액티브 시스템 구축을 위한 일종의 설계 원칙 / 시스템의 특징이라고 할 수 있다.

### MEANS (수단)
  - 리액티브 시스템에서 주요 통신 수단으로 무엇을 사용할 것인지 표현한 것
  - 비동기 메시지 기반의 통신을 통해서 구성요소들 간의 느슨한 결합, 격리성, 위치 투명성을 보장한다.
### FORM (형성)
  - 메시지 기반 통신을 통해서 어떠한 형태를 지니는 시스템으로 형성되는지를 나타낸다.
  - 리액티브 시스템이 비동기 메시지 통신 기반하에 **탄력성과 회복성**을 가지는 시스템이어야 함을 보여준다.
    - 탄력성 (Elastic)이란 시스템의 작업량이 변화하더라도 일정한 응답을 유지하는 것을 의미
      - 일정한 응답을 유지하기 위해 입력을 처리하기 위한 시스템 자원을 그때 그때 추가하거나 감소해서 변화에 대응한다.
    - 회복성 (Resilient)이란 시스템에 장애가 발생하더라도 응답성을 유지하는 것을 의미
      - 회복성이 없다면 장애 발생 시 시스템이 응답하지 못하는 심각한 문제에 직면하기 때문에 이를 방지하는 것이 필요하다.
      - 이를 확보하기 위해 비동기 메시지 기반 통신을 통해 느슨한 결합과 격리성을 보장
      - 즉, 시스템의 구성요소들이 독립적으로 분리되기 때문에 장애가 발생하더라도 전체 시스템은 여전히 응답 가능하고 장애가 발생한 부분만 복구하면 된다는 의미
### VALUE (가치)
  - 비동기 메시지 기반 통신을 바탕으로 한 회복성과 예측 가능한 규모 확장 알고리즘을 통해 시스템의 처리량을 자동으로 확장하고 축소하는 탄력성을 확보함으로써 즉각적으로 응답 가능한 시스템을 구축할 수 있음을 의미
  - 바로 리액티브 시스템의 핵심 가치

### 결론
- 설계 원칙에 따라 **빠른 응답성을 바탕으로 유지보수와 확장이 용이한 시스템**을 구축하는 데 활용할 수 있다.

- [리액티브 선언문](https://www.reactivemanifesto.org/)
- [리액티브 선언문 용어집](https://www.reactivemanifesto.org/ko/glossary)

## 1.3 리액티브 프로그래밍이란?
- 리액티브 프로그래밍이란 **리액티브 시스템을 구축하는 데 필요한 프로그래밍 모델**
- 리액티브 시스템에서의 비동기 메시지 통신은 Non-Blocking I/O 방식의 통신
  - Blocking 방식의 통신에서는 해당 스레드가 작업을 처리할 때까지 남아 있는 작업들은 해당 작업이 끝날 때까지 차단되어 대기한다.
  - 따라서 남아 있는 작업들을 대기 없이 처리하려면 별도의 추가 스레드를 할당해야 해서 그만큼의 비용이 더 들게 된다.
- 반면에 Non-Blocking 방식의 통신에서는 말 그대로 스레드가 차단되지 않는다.
- 결론적으로 리액티브 프로그래밍은 리액티브 시스템의 설계 원칙에 잘 부합하는 비동기 Non-Blocking 통신을 위한 프로그래밍 모델이라고 볼 수 있다.

## 1.4 리액티브 프로그래밍의 특징
> In computing, reactive programming is a **declarative programming** paradigm concerned with **data streams** and **the propagation of change**.

### 1.4.1 declarative programming
- declarative programming은 선언형 프로그래밍
- 우리가 흔히 사용하는 전통적인 프로그래밍 방식은 C언어나 Java 같은 명령형 프로그래밍 방식이다.
- 즉, 실행할 동작을 구체적으로 명시하는 프로그래밍 코드 형태라 볼 수 있음.
- 반면, 선언형 프로그래밍 방식은 명령형 프로그래밍 방식과 달리 실행할 동작을 구체적으로 명시하지 않고 이러이러한 동작을 하겠다는 목표만 선언한다.

### 1.4.2 data streams와 the propagation of change
- data streams라는 것은 데이터 흐름, **즉 데이터가 지속적으로 발생한다는 의미이고**, the propagation of change는 **지속적으로 데이터가 발생할 때마다 이것을 변화하는 이벤트로 보고** 이 이벤트를 발생시키면서 데이터를 계속적으로 전달하는 것을 의미한다.

## 1.5 코드로 보는 명령형 프로그래밍 vs 선언형 프로그래밍
- 명령형 방식은 어떤 작업을 처리하기 위해 실행할 동작을 코드에 구체적으로 명시
- 선언형 방식은 실행할 동작을 구체적으로 명싷자ㅣ 않고 목표만 선언하는 방식

### 1.5.1 명령형 프로그래밍
```java
public class Example1_1 {
    public static void main(String[] args) {
        List<Integer> numbers = Arrays.asList(1, 3, 21, 10, 8, 11);
        int sum = 0;
        for(int number : numbers) {
            if (number > 6 && (number % 2 != 0)) {
                sum += number;
            }
        }

        System.out.println("합계: " + sum);
    }
}
```
과 같이 작업을 처리하기 위한 구체적인 동작을 코드에 명시한다.
1. for문을 돌면서 numbers에서 각각의 숫자들에 접근하는 동작
2. if문을 사용해서 조건에 맞는 숫자를 선택하기 위한 동작
3. 조건문으로 선택된 숫자를 sum이라는 변수에 차례차례 더하는 동작

### 1.5.2 선언형 프로그래밍
``` java
public class Example1_2 {
    public static void main(String[] args) {
        List<Integer> numbers = Arrays.asList(1, 3, 21, 10, 8, 11);
        int sum = numbers.stream()
            .filter(number -> number > 6 && (number % 2 != 0))
            .mapToInt(number -> number)
            .sum() ;

        System.out.println(sum);
    }
}
```
리액티브 프로그래밍은 아니지만 선언형 프로그래밍 방식의 예제를 위해 Java의 스트림을 사용했다.

1. 당장 명령형에서 볼 수 있던 for문이 사라졌다. for문에서 하는 구체적인 동작은 Java의 스트림이 내부에서 직접 해 준다.
   1. for문에 직접 접근하는 동작을 섬령하기보다는 접근을 해줘 라고 내가 아닌 누군가에게 부탁하는 것과 비슷하다.
2. if문 대신 Filter를 사용해서 조건만을 명시
3. sum 메서드를 선언 -> 직접 더하는 동작은 스트림 내부에서 대신 처리

### 정리
1. 선언형 프로그래밍 방식에서는 동작을 구체적으로 명시하지 않고 목표만 선언.
2. 여러 가지 동작을 별도의 코드로 분리하지 않고 각 동작에 대해서 메서드 체인을 형성해서 한 문장으로 된 코드로 구성
   1. 코드가 간결해지고 가독성도 좋아진다.
3. 선언형 방식은 함수형 프로그래밍으로 구성된다.

## 1.6 리액티브 프로그래밍 코드 구성

우리가 실제로 작성하는 리액티브 프로그래밍 코드는 크게 Publisher, Subscriber, Data Source, Operator 등으로 구성된다.

### Publisher
- 발행인, 발행자 정도로 해석 가능
- 입력으로 들어오는 데이터를 제공하는 역할을 한다.

### Subscriber
- Publisher가 제공한 데이터를 전달받아서 사용하는 주체
- 발행자의 반대 의미로 구독자라고도 불리고, 생산자의 반대 의미로 소비자라고도 불린다.

### Data Source
- Publisher의 입력으로 들어오는 데이터를 대표하는 용어로, 리액티브에서는 Data Stream이라고도 표현한다.
  - Data Source는 말 그대로 원천 데이터, 즉 최초로 생성되는 데이터 그 자체
  - Data Stream은 Publisher의 입력으로 들어오는 데이터의 형태

### Operator
- Publisher로부터 전달된 데이터가 순수하게 아무런 처리를 거치지 않고 그대로 Subscriber에 전달되는 경우는 거의 없다.
- 적절한 가공 처리를 담당하는 역할을 한다.
  - 데이터 필터링, 데이터 변환 등 수많은 Operator가 존재

## 마무리
1. 리액티브 시스템의 설계
   1. 비동기 메시지 기반 통신
   2. 탄력적이고 회복성을 지녀야 함
   3. 높은 응답성을 지녀야 함
   4. 유지보수와 확장이 용이해야 함
2. 리액티브 프로그래밍의 특징
   1. 선언형 프로그래밍 방식
   2. 데이터 소스의 변경이 있을 때마다 데이터를 전파
   3. 코드의 간결함고 가독성에 유리한 메서드 체인의 형태로 표현
   4. 함수형 프로그래밍 방식의 코드 형태로 파라미터를 가짐
3. 리액티브 프로그래밍 코드의 구성요소
   1. Publisher는 입력으로 들어오는 데이터를 Subscriber에 제공
   2. Subscriber는 Publisher로부터 전달받은 데이터를 사용
   3. Data Source는 Publisher의 입력으로 전달되는 데이터
   4. Operator는 중간에서 데이터를 가공

> - **리액티브 시스템**은 **리액티브 프로그래밍 모델** 방식으로 구축
> - **리액티브 스트림즈**는 리액티브한 코드를 작성하기 위한 리액티브 라이브러리의 표준 사양
> - 해당 사양을 구현한 **구현체**는 RxJava, **Reactor**, Akka Streams, Java 9 Flow API